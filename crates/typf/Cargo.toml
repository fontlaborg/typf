[package]
name = "typf"
version = "2.0.0-dev"
authors = ["TYPF Contributors"]
edition = "2021"
license = "MIT OR Apache-2.0"

[dependencies]
typf-core = { workspace = true }
typf-input = { workspace = true, optional = true }
typf-unicode = { workspace = true, optional = true }
typf-fontdb = { workspace = true, optional = true }
typf-export = { workspace = true, optional = true }

# Shaping backends
typf-shape-none = { workspace = true, optional = true }
typf-shape-hb = { workspace = true, optional = true }
typf-shape-ct = { workspace = true, optional = true }
typf-shape-icu-hb = { workspace = true, optional = true }

# Rendering backends
typf-render-json = { workspace = true, optional = true }
typf-render-orge = { workspace = true, optional = true }
typf-render-cg = { workspace = true, optional = true }
typf-render-skia = { workspace = true, optional = true }
typf-render-zeno = { workspace = true, optional = true }

# External dependencies
thiserror = { workspace = true }
log = { workspace = true }
wasm-bindgen = { version = "0.2", optional = true }
console_error_panic_hook = { version = "0.1", optional = true }

[features]
default = ["minimal", "unicode", "fontdb", "export-pnm"]

# Minimal configuration (no external dependencies)
minimal = ["shaping-none", "render-orge"]

# Component features
unicode = ["dep:typf-unicode"]
fontdb = ["dep:typf-fontdb"]
input = ["dep:typf-input"]

# Export formats
export-pnm = ["dep:typf-export"]
export-png = []  # Future: requires image crate
export-svg = []  # Future: requires svg crate
export-pdf = []  # Future: requires pdf writer

# Shaping backends
shaping-none = ["dep:typf-shape-none"]
shaping-hb = ["dep:typf-shape-hb"]
shaping-ct = ["dep:typf-shape-ct"]
shaping-icu-hb = ["dep:typf-shape-icu-hb", "unicode"]
shaping-mac = ["shaping-ct"]  # Alias for CoreText
shaping-win = []  # Future: ["dep:typf-shape-win"] - requires Windows

# Rendering backends
render-json = ["dep:typf-render-json"]
render-orge = ["dep:typf-render-orge"]
render-cg = ["dep:typf-render-cg"]
render-skia = ["dep:typf-render-skia"]
render-zeno = ["dep:typf-render-zeno"]
render-mac = ["render-cg"]   # Alias for CoreGraphics
render-win = []   # Future: ["dep:typf-render-win"] - requires Windows

# Advanced features
simd = []     # Enable SIMD optimizations
parallel = [] # Enable parallel processing
auto-backend = [] # Auto-select best backend for platform
wasm = ["dep:wasm-bindgen"]
console_error_panic_hook = ["dep:console_error_panic_hook"]

# Full build with all features
full = [
    "unicode", "fontdb", "input",
    "export-pnm",
    "shaping-none", "shaping-hb", "shaping-ct", "shaping-icu-hb",
    "render-json", "render-orge", "render-cg", "render-skia", "render-zeno",
]

[dev-dependencies]
typf-shape-none = { workspace = true }
typf-render-orge = { workspace = true }
typf-export = { workspace = true }
criterion = "0.5"

[[bench]]
name = "pipeline_bench"
harness = false
path = "../../benches/pipeline_bench.rs"

[[example]]
name = "basic"
path = "../../examples/basic.rs"
required-features = ["minimal", "export-pnm"]

[[example]]
name = "pipeline"
path = "../../examples/pipeline.rs"
required-features = ["minimal", "export-pnm"]

[[example]]
name = "formats"
path = "../../examples/formats.rs"
required-features = ["minimal", "export-pnm"]

[[example]]
name = "harfbuzz"
path = "../../examples/harfbuzz.rs"
required-features = ["fontdb", "shaping-hb"]

[[example]]
name = "variable_fonts"
path = "../../examples/variable_fonts.rs"
required-features = ["shaping-hb"]

[[example]]
name = "long_text_handling"
path = "../../examples/long_text_handling.rs"
required-features = ["shaping-hb", "export-svg"]